<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="using:Nova.Avalonia.UI.Controls"
             xmlns:vm="using:Nova.Avalonia.UI.Gallery.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="1200"
             x:Class="Nova.Avalonia.UI.Gallery.Views.VariableSizeWrapPanelView"
             x:DataType="vm:VariableSizeWrapPanelViewModel">

    <ScrollViewer HorizontalScrollBarVisibility="Disabled">
        <StackPanel Spacing="20" Margin="20">
            <TextBlock Text="VariableSizeWrapPanel" Theme="{StaticResource TitleTextBlockStyle}"/>
            <TextBlock Text="Windows Metro-style tile layout with variable-size tiles." Theme="{StaticResource BodyTextBlockStyle}" Opacity="0.6"/>

            <!-- Basic Usage -->
            <Border BorderBrush="{DynamicResource AccentMutedBrush}" BorderThickness="2" Padding="15" CornerRadius="8">
                <StackPanel Spacing="10">
                    <TextBlock Text="Basic Usage" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource AccentBrush}"/>
                    <TextBlock Text="Tiles auto-flow with ColumnSpan and RowSpan for variable sizes." Foreground="{DynamicResource SecondaryTextBrush}"/>
                    
                    <Border Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" CornerRadius="4" Padding="10" ClipToBounds="True">
                        <controls:VariableSizeWrapPanel TileSize="80" Spacing="8" Columns="4">
                            <!-- Large 2x2 tile - Mail -->
                            <Border Background="#3498DB" CornerRadius="8" controls:VariableSizeWrapPanel.ColumnSpan="2" controls:VariableSizeWrapPanel.RowSpan="2">
                                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <Path Data="M2 4h20v16H2V4zm18 2l-8 5-8-5v12h16V6zm-8 3.5L18.5 6h-13L12 9.5z" 
                                          Fill="White" Width="40" Height="32" Stretch="Uniform"/>
                                    <TextBlock Text="Mail" Foreground="White" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Small 1x1 tiles - Calendar -->
                            <Border Background="#2ECC71" CornerRadius="8">
                                <Path Data="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z" 
                                      Fill="White" Width="28" Height="28" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <!-- Music -->
                            <Border Background="#E74C3C" CornerRadius="8">
                                <Path Data="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z" 
                                      Fill="White" Width="28" Height="28" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            
                            <!-- Wide 2x1 tile - Weather -->
                            <Border Background="#9B59B6" CornerRadius="8" controls:VariableSizeWrapPanel.ColumnSpan="2">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="10">
                                    <Path Data="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2H6zM12 2C6.5 2 2 6.5 2 12c0 2.3.8 4.4 2.1 6h15.8c1.3-1.6 2.1-3.7 2.1-6 0-5.5-4.5-10-10-10z" 
                                          Fill="White" Width="24" Height="24" Stretch="Uniform"/>
                                    <TextBlock Text="Weather" Foreground="White" FontWeight="Bold" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Camera -->
                            <Border Background="#F39C12" CornerRadius="8">
                                <Path Data="M12 10.8c-1.77 0-3.2 1.43-3.2 3.2s1.43 3.2 3.2 3.2 3.2-1.43 3.2-3.2-1.43-3.2-3.2-3.2zM20 4h-3.17L15 2H9L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2z" 
                                      Fill="White" Width="28" Height="28" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <!-- Game -->
                            <Border Background="#1ABC9C" CornerRadius="8">
                                <Path Data="M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-10 7H8v3H6v-3H3v-2h3V8h2v3h3v2zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4-3c-.83 0-1.5-.67-1.5-1.5S18.67 9 19.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z" 
                                      Fill="White" Width="28" Height="28" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            
                            <!-- Tall 1x2 tile - Phone -->
                            <Border Background="#E91E63" CornerRadius="8" controls:VariableSizeWrapPanel.RowSpan="2">
                                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <Path Data="M15.5 1h-8C6.12 1 5 2.12 5 3.5v17C5 21.88 6.12 23 7.5 23h8c1.38 0 2.5-1.12 2.5-2.5v-17C18 2.12 16.88 1 15.5 1zm-4 21c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zM16 18H7V4h9v14z" 
                                          Fill="White" Width="32" Height="32" Stretch="Uniform"/>
                                    <TextBlock Text="Phone" Foreground="White" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Settings -->
                            <Border Background="#00BCD4" CornerRadius="8">
                                <Path Data="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z" 
                                      Fill="White" Width="28" Height="28" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <!-- Notifications -->
                            <Border Background="#FF5722" CornerRadius="8">
                                <Path Data="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z" 
                                      Fill="White" Width="28" Height="28" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <!-- Folder -->
                            <Border Background="#795548" CornerRadius="8">
                                <Path Data="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z" 
                                      Fill="White" Width="28" Height="28" Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                        </controls:VariableSizeWrapPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Configuration -->
            <Border BorderBrush="{DynamicResource AccentMutedBrush}" BorderThickness="2" Padding="15" CornerRadius="8">
                <StackPanel Spacing="10">
                    <TextBlock Text="Configuration" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource AccentBrush}"/>
                    
                    <Grid ColumnDefinitions="Auto, *, 50" RowDefinitions="Auto, Auto, Auto">
                        <TextBlock Text="Tile Size" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <Slider Grid.Column="1" Minimum="40" Maximum="120" Value="{Binding TileSize}"/>
                        <TextBlock Grid.Column="2" Text="{Binding TileSize, StringFormat='{}{0:0}'}" VerticalAlignment="Center" HorizontalAlignment="Right"/>

                        <TextBlock Grid.Row="1" Text="Spacing" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <Slider Grid.Row="1" Grid.Column="1" Minimum="0" Maximum="20" Value="{Binding Spacing}"/>
                        <TextBlock Grid.Row="1" Grid.Column="2" Text="{Binding Spacing, StringFormat='{}{0:0}'}" VerticalAlignment="Center" HorizontalAlignment="Right"/>

                        <TextBlock Grid.Row="2" Text="Columns" VerticalAlignment="Center" Margin="0,0,10,0"/>
                        <Slider Grid.Row="2" Grid.Column="1" Minimum="2" Maximum="6" Value="{Binding Columns}"/>
                        <TextBlock Grid.Row="2" Grid.Column="2" Text="{Binding Columns, StringFormat='{}{0:0}'}" VerticalAlignment="Center" HorizontalAlignment="Right"/>
                    </Grid>

                    <Border Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" CornerRadius="4" Padding="10" ClipToBounds="True">
                        <controls:VariableSizeWrapPanel TileSize="{Binding TileSize}" 
                                             Spacing="{Binding Spacing}" 
                                             Columns="{Binding Columns}">
                            <Border Background="#3498DB" CornerRadius="8" controls:VariableSizeWrapPanel.ColumnSpan="2" controls:VariableSizeWrapPanel.RowSpan="2"/>
                            <Border Background="#2ECC71" CornerRadius="8"/>
                            <Border Background="#E74C3C" CornerRadius="8"/>
                            <Border Background="#9B59B6" CornerRadius="8" controls:VariableSizeWrapPanel.ColumnSpan="2"/>
                            <Border Background="#F39C12" CornerRadius="8"/>
                            <Border Background="#1ABC9C" CornerRadius="8"/>
                            <Border Background="#E91E63" CornerRadius="8" controls:VariableSizeWrapPanel.RowSpan="2"/>
                            <Border Background="#00BCD4" CornerRadius="8"/>
                            <Border Background="#FF5722" CornerRadius="8"/>
                        </controls:VariableSizeWrapPanel>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Dashboard Example -->
            <Border BorderBrush="{DynamicResource AccentMutedBrush}" BorderThickness="2" Padding="15" CornerRadius="8">
                <StackPanel Spacing="10">
                    <TextBlock Text="Dashboard Layout" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource AccentBrush}"/>
                    <TextBlock Text="Creating a dashboard with mixed tile sizes." Foreground="{DynamicResource SecondaryTextBrush}"/>
                    
                    <Border Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" CornerRadius="4" Padding="10" ClipToBounds="True">
                        <controls:VariableSizeWrapPanel TileSize="70" Spacing="6" Columns="5">
                            <!-- Header tile -->
                            <Border Background="#2C3E50" CornerRadius="8" controls:VariableSizeWrapPanel.ColumnSpan="3" controls:VariableSizeWrapPanel.RowSpan="2">
                                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Text="Dashboard" Foreground="White" FontSize="20" FontWeight="Bold"/>
                                    <TextBlock Text="Welcome back!" Foreground="White" Opacity="0.7"/>
                                </StackPanel>
                            </Border>
                            
                            <Border Background="#27AE60" CornerRadius="8" controls:VariableSizeWrapPanel.RowSpan="2">
                                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Text="128" Foreground="White" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Messages" Foreground="White" FontSize="10" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#C0392B" CornerRadius="8" controls:VariableSizeWrapPanel.RowSpan="2">
                                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Text="5" Foreground="White" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    <TextBlock Text="Alerts" Foreground="White" FontSize="10" HorizontalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            
                            <Border Background="#8E44AD" CornerRadius="8" controls:VariableSizeWrapPanel.ColumnSpan="2"/>
                            <Border Background="#16A085" CornerRadius="8"/>
                            <Border Background="#D35400" CornerRadius="8"/>
                            <Border Background="#2980B9" CornerRadius="8"/>
                        </controls:VariableSizeWrapPanel>
                    </Border>
                </StackPanel>
            </Border>
            <!-- Dynamic Items -->
            <Border BorderBrush="{DynamicResource AccentMutedBrush}" BorderThickness="2" Padding="15" CornerRadius="8">
                <StackPanel Spacing="10">
                    <TextBlock Text="Dynamic Items" FontWeight="Bold" FontSize="16" Foreground="{DynamicResource AccentBrush}"/>
                    <TextBlock Text="Add or remove items to see the tile grid reflow." Foreground="{DynamicResource SecondaryTextBrush}"/>

                    <StackPanel Orientation="Horizontal" Spacing="10">
                        <Button Content="Add Item" Command="{Binding AddItemCommand}"/>
                        <Button Content="Remove Item" Command="{Binding RemoveItemCommand}"/>
                        <TextBlock Text="{Binding Items.Count, StringFormat='Count: {0}'}" VerticalAlignment="Center"/>
                    </StackPanel>

                    <Border Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}" CornerRadius="4" Padding="10" Height="300" ClipToBounds="True">
                        <ItemsControl ItemsSource="{Binding Items}" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <controls:VariableSizeWrapPanel TileSize="60" Spacing="6" Columns="4"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="vm:MetroItem">
                                    <Border Background="{Binding Brush}" CornerRadius="6"
                                            controls:VariableSizeWrapPanel.ColumnSpan="{Binding ColumnSpan}"
                                            controls:VariableSizeWrapPanel.RowSpan="{Binding RowSpan}"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Border>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
